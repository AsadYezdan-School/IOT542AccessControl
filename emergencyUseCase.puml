@startuml
top to bottom direction
skinparam actorStyle awesome
skinparam packageStyle rectangle
skinparam linetype ortho

package "Actors" as Actors {
  actor "Facility User\n(Researcher, Technician etc.)" as FacilityUser
  actor "Privilege Broker" as PrivAuthority
  actor "Audit Stakeholder" as AuditStakeholder
}


' System boundary
rectangle "Emergency Access System" as EAS {

  package "Privileged Operations" as P_PrivOps {
    usecase "Request Emergency Access" as UC_RequestEA
    usecase "Grant Emergency Access\n(Break-glass)" as UC_GrantEA
    usecase "Manage Permissions\n(Assign/Remove Room Access)" as UC_Permissions
  }

  package "Accountability" as P_Audit {
    usecase "Record Justification &\nIncident Reference" as UC_Justify
    usecase "Post-incident Review / Audit" as UC_Audit
  }
}

Actors -[hidden]down-> EAS

P_PrivOps -[hidden]down-> P_Audit

' Keep actors aligned over the packages they mainly talk to
FacilityUser   -[hidden]right-> PrivAuthority
PrivAuthority  -[hidden]right-> AuditStakeholder


' Associations

' Emergency request (user-initiated)
FacilityUser -down-> UC_RequestEA


' Privilege Broker
PrivAuthority -down-> UC_GrantEA
PrivAuthority -down-> UC_Permissions



UC_Justify -[hidden]right-> UC_Audit

PrivAuthority -[hidden]left->AuditStakeholder
UC_GrantEA -> P_Audit : <<include>>
UC_Permissions -down-> P_Audit
UC_Audit -> UC_Justify : <<include>>

@enduml