@startuml
top to bottom direction
skinparam actorStyle awesome
skinparam packageStyle rectangle
skinparam linetype ortho

package "Actors" as Actors {
  actor "Facility User\n(Researcher, Technician etc.)" as FacilityUser
  actor "Privilege Broker" as PrivAuthority
  actor "Audit Stakeholder" as AuditStakeholder
}


' System boundary
rectangle "Emergency Access System" as EAS {

  package "Privileged Operations" as P_PrivOps {
    usecase "Request Emergency Access" as UC_RequestEA
    usecase "Grant Emergency Access\n(Break-glass)" as UC_GrantEA
    usecase "Suspend/Cancel Access" as UC_Suspend
  }

  package "Administration" as P_Admin {
    usecase "Manage Permissions\n(Assign/Remove Room Access)" as UC_Permissions
  }

  package "Accountability" as P_Audit {
    usecase "Record Justification &\nIncident Reference" as UC_Justify
    usecase "Post-incident Review / Audit" as UC_Audit
  }
}

Actors -[hidden]down-> EAS

P_PrivOps -[hidden]down-> P_Audit
P_Audit   -[hidden]down-> P_Admin

' Keep actors aligned over the packages they mainly talk to
FacilityUser   -[hidden]right-> PrivAuthority
PrivAuthority  -[hidden]right-> AuditStakeholder


' Associations

' Emergency request (user-initiated)
FacilityUser -down-> UC_RequestEA


' Privilege Broker
PrivAuthority -down-> UC_GrantEA
PrivAuthority -down-> UC_Suspend
PrivAuthority -down-> UC_Permissions

' Audit / review
AuditStakeholder -down-> UC_Suspend

UC_GrantEA     ..> UC_Justify : <<include>>
UC_GrantEA    ..> UC_Justify : <<include>>
UC_Suspend     ..> UC_Justify : <<include>>
UC_Permissions ..> UC_Justify : <<include>>

UC_Audit ..> UC_GrantEA     : <<extend>>
UC_Audit ..> UC_GrantEA    : <<extend>>
UC_Audit ..> UC_Suspend     : <<extend>>
UC_Audit ..> UC_Permissions : <<extend>>

@enduml